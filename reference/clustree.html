<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a clustering tree — clustree • clustree</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot a clustering tree — clustree" />
<meta property="og:description" content="Creates a plot of a clustering tree showing the relationship between
clusterings at different resolutions." />
<meta property="og:image" content="http://lazappi.github.io/clustree/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-52309538-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-52309538-5');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clustree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/clustree.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lazappi/clustree/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a clustering tree</h1>
    <small class="dont-index">Source: <a href='https://github.com/lazappi/clustree/blob/master/R/clustree.R'><code>R/clustree.R</code></a></small>
    <div class="hidden name"><code>clustree.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a plot of a clustering tree showing the relationship between
clusterings at different resolutions.</p>
    </div>

    <pre class="usage"><span class='fu'>clustree</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for matrix</span>
<span class='fu'>clustree</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>prefix</span>,
  suffix <span class='op'>=</span> <span class='cn'>NULL</span>,
  metadata <span class='op'>=</span> <span class='cn'>NULL</span>,
  count_filter <span class='op'>=</span> <span class='fl'>0</span>,
  prop_filter <span class='op'>=</span> <span class='fl'>0.1</span>,
  layout <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tree"</span>, <span class='st'>"sugiyama"</span><span class='op'>)</span>,
  use_core_edges <span class='op'>=</span> <span class='cn'>TRUE</span>,
  highlight_core <span class='op'>=</span> <span class='cn'>FALSE</span>,
  node_colour <span class='op'>=</span> <span class='va'>prefix</span>,
  node_colour_aggr <span class='op'>=</span> <span class='cn'>NULL</span>,
  node_size <span class='op'>=</span> <span class='st'>"size"</span>,
  node_size_aggr <span class='op'>=</span> <span class='cn'>NULL</span>,
  node_size_range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>15</span><span class='op'>)</span>,
  node_alpha <span class='op'>=</span> <span class='fl'>1</span>,
  node_alpha_aggr <span class='op'>=</span> <span class='cn'>NULL</span>,
  node_text_size <span class='op'>=</span> <span class='fl'>3</span>,
  scale_node_text <span class='op'>=</span> <span class='cn'>FALSE</span>,
  node_text_colour <span class='op'>=</span> <span class='st'>"black"</span>,
  node_label <span class='op'>=</span> <span class='cn'>NULL</span>,
  node_label_aggr <span class='op'>=</span> <span class='cn'>NULL</span>,
  node_label_size <span class='op'>=</span> <span class='fl'>3</span>,
  node_label_nudge <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.2</span>,
  edge_width <span class='op'>=</span> <span class='fl'>1.5</span>,
  edge_arrow <span class='op'>=</span> <span class='cn'>TRUE</span>,
  edge_arrow_ends <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"last"</span>, <span class='st'>"first"</span>, <span class='st'>"both"</span><span class='op'>)</span>,
  show_axis <span class='op'>=</span> <span class='cn'>FALSE</span>,
  return <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"plot"</span>, <span class='st'>"graph"</span>, <span class='st'>"layout"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>clustree</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>prefix</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for SingleCellExperiment</span>
<span class='fu'>clustree</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>prefix</span>, exprs <span class='op'>=</span> <span class='st'>"counts"</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for seurat</span>
<span class='fu'>clustree</span><span class='op'>(</span><span class='va'>x</span>, prefix <span class='op'>=</span> <span class='st'>"res."</span>, exprs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"raw.data"</span>, <span class='st'>"scale.data"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for Seurat</span>
<span class='fu'>clustree</span><span class='op'>(</span>
  <span class='va'>x</span>,
  prefix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>assay</span>, <span class='st'>"_snn_res."</span><span class='op'>)</span>,
  exprs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"counts"</span>, <span class='st'>"scale.data"</span><span class='op'>)</span>,
  assay <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>object containing clustering data</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>extra parameters passed to other methods</p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>string indicating columns containing clustering information</p></td>
    </tr>
    <tr>
      <th>suffix</th>
      <td><p>string at the end of column names containing clustering
information</p></td>
    </tr>
    <tr>
      <th>metadata</th>
      <td><p>data.frame containing metadata on each sample that can be
used as node aesthetics</p></td>
    </tr>
    <tr>
      <th>count_filter</th>
      <td><p>count threshold for filtering edges in the clustering
graph</p></td>
    </tr>
    <tr>
      <th>prop_filter</th>
      <td><p>in proportion threshold for filtering edges in the
clustering graph</p></td>
    </tr>
    <tr>
      <th>layout</th>
      <td><p>string specifying the "tree" or "sugiyama" layout, see
<code><a href='https://rdrr.io/pkg/igraph/man/layout_as_tree.html'>igraph::layout_as_tree()</a></code> and <code><a href='https://rdrr.io/pkg/igraph/man/layout_with_sugiyama.html'>igraph::layout_with_sugiyama()</a></code> for details</p></td>
    </tr>
    <tr>
      <th>use_core_edges</th>
      <td><p>logical, whether to only use core tree (edges with
maximum in proportion for a node) when creating the graph layout, all
(unfiltered) edges will still be displayed</p></td>
    </tr>
    <tr>
      <th>highlight_core</th>
      <td><p>logical, whether to increase the edge width of the core
network to make it easier to see</p></td>
    </tr>
    <tr>
      <th>node_colour</th>
      <td><p>either a value indicating a colour to use for all nodes or
the name of a metadata column to colour nodes by</p></td>
    </tr>
    <tr>
      <th>node_colour_aggr</th>
      <td><p>if <code>node_colour</code> is a column name than a string
giving the name of a function to aggregate that column for samples in each
cluster</p></td>
    </tr>
    <tr>
      <th>node_size</th>
      <td><p>either a numeric value giving the size of all nodes or the
name of a metadata column to use for node sizes</p></td>
    </tr>
    <tr>
      <th>node_size_aggr</th>
      <td><p>if <code>node_size</code> is a column name than a string
giving the name of a function to aggregate that column for samples in each
cluster</p></td>
    </tr>
    <tr>
      <th>node_size_range</th>
      <td><p>numeric vector of length two giving the maximum and
minimum point size for plotting nodes</p></td>
    </tr>
    <tr>
      <th>node_alpha</th>
      <td><p>either a numeric value giving the alpha of all nodes or the
name of a metadata column to use for node transparency</p></td>
    </tr>
    <tr>
      <th>node_alpha_aggr</th>
      <td><p>if <code>node_aggr</code> is a column name than a string
giving the name of a function to aggregate that column for samples in each
cluster</p></td>
    </tr>
    <tr>
      <th>node_text_size</th>
      <td><p>numeric value giving the size of node text if
<code>scale_node_text</code> is <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>scale_node_text</th>
      <td><p>logical indicating whether to scale node text along
with the node size</p></td>
    </tr>
    <tr>
      <th>node_text_colour</th>
      <td><p>colour value for node text (and label)</p></td>
    </tr>
    <tr>
      <th>node_label</th>
      <td><p>additional label to add to nodes</p></td>
    </tr>
    <tr>
      <th>node_label_aggr</th>
      <td><p>if <code>node_label</code> is a column name than a string
giving the name of a function to aggregate that column for samples in each
cluster</p></td>
    </tr>
    <tr>
      <th>node_label_size</th>
      <td><p>numeric value giving the size of node label text</p></td>
    </tr>
    <tr>
      <th>node_label_nudge</th>
      <td><p>numeric value giving nudge in y direction for node
labels</p></td>
    </tr>
    <tr>
      <th>edge_width</th>
      <td><p>numeric value giving the width of plotted edges</p></td>
    </tr>
    <tr>
      <th>edge_arrow</th>
      <td><p>logical indicating whether to add an arrow to edges</p></td>
    </tr>
    <tr>
      <th>edge_arrow_ends</th>
      <td><p>string indicating which ends of the line to draw arrow
heads if <code>edge_arrow</code> is <code>TRUE</code>, one of "last", "first", or "both"</p></td>
    </tr>
    <tr>
      <th>show_axis</th>
      <td><p>whether to show resolution axis</p></td>
    </tr>
    <tr>
      <th>return</th>
      <td><p>string specifying what to return, either "plot" (a <code>ggplot</code>
object), "graph" (a <code>tbl_graph</code> object) or "layout" (a <code>ggraph</code> layout
object)</p></td>
    </tr>
    <tr>
      <th>exprs</th>
      <td><p>source of gene expression information to use as node aesthetics,
for <code>SingleCellExperiment</code> objects it must be a name in <code>assayNames(x)</code>, for
a <code>seurat</code> object it must be one of <code>data</code>, <code>raw.data</code> or <code>scale.data</code> and
for a <code>Seurat</code> object it must be one of <code>data</code>, <code>counts</code> or <code>scale.data</code></p></td>
    </tr>
    <tr>
      <th>assay</th>
      <td><p>name of assay to pull expression and clustering data from for
<code>Seurat</code> objects</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>ggplot</code> object (default), a <code>tbl_graph</code> object or a <code>ggraph</code>
layout object depending on the value of <code>return</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Data sources</strong></p>
<p>Plotting a clustering tree requires information about which cluster each
sample has been assigned to at different resolutions. This information can
be supplied in various forms, as a matrix, data.frame or more specialised
object. In all cases the object provided must contain numeric columns with
the naming structure <code>PXS</code> where <code>P</code> is a prefix indicating that the column
contains clustering information, <code>X</code> is a numeric value indicating the
clustering resolution and <code>S</code> is any additional suffix to be removed. For
<code>SingleCellExperiment</code> objects this information must be in the <code>colData</code> slot
and for <code>Seurat</code> objects it must be in the <code>meta.data</code> slot. For all objects
except matrices any additional columns can be used as aesthetics, for
matrices an additional metadata data.frame can be supplied if required.</p>
<p><strong>Filtering</strong></p>
<p>Edges in the graph can be filtered by adjusting the <code>count_filter</code> and
<code>prop_filter</code> parameters. The <code>count_filter</code> removes any edges that represent
less than that number of samples, while the <code>prop_filter</code> removes edges that
represent less than that proportion of cells in the node it points towards.</p>
<p><strong>Node aesthetics</strong></p>
<p>The aesthetics of the plotted nodes can be controlled in various ways. By
default the colour indicates the clustering resolution, the size indicates
the number of samples in that cluster and the transparency is set to 100%.
Each of these can be set to a specific value or linked to a supplied metadata
column. For a <code>SingleCellExperiment</code> or <code>Seurat</code> object the names of genes
can also be used. If a metadata column is used than an aggregation function
must also be supplied to combine the samples in each cluster. This function
must take a vector of values and return a single value.</p>
<p><strong>Layout</strong></p>
<p>The clustering tree can be displayed using either the Reingold-Tilford tree
layout algorithm or the Sugiyama layout algorithm for layered directed
acyclic graphs. These layouts were selected as the are the algorithms
available in the <code>igraph</code> package designed for trees. The Reingold-Tilford
algorithm places children below their parents while the Sugiyama places
nodes in layers while trying to minimise the number of crossing edges. See
<code><a href='https://rdrr.io/pkg/igraph/man/layout_as_tree.html'>igraph::layout_as_tree()</a></code> and <code><a href='https://rdrr.io/pkg/igraph/man/layout_with_sugiyama.html'>igraph::layout_with_sugiyama()</a></code> for more
details. When <code>use_core_edges</code> is <code>TRUE</code> (default) only the core tree of the
maximum in proportion edges for each node are used for constructing the
layout. This can often lead to more attractive layouts where the core tree is
more visible.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>nba_clusts</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>clustree</span><span class='op'>(</span><span class='va'>nba_clusts</span>, prefix <span class='op'>=</span> <span class='st'>"K"</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>The `add` argument of `group_by()` is deprecated as of dplyr 1.0.0.</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> Please use the `.add` argument instead.</span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span style='color: #555555;'>This warning is displayed once every 8 hours.</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span style='color: #555555;'>Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span>
<span class='r-plt img'><img src='clustree-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Luke Zappia, Alicia Oshlack.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


